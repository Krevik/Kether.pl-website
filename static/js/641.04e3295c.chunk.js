"use strict";(globalThis.webpackChunkkether_pl=globalThis.webpackChunkkether_pl||[]).push([[641],{5475:(e,t,n)=>{n.d(t,{K:()=>i});const a="PageWithBackground_pageWithBackground__nL8hr";n(5485);var s=n(8505);const i=e=>(0,s.jsx)("div",{className:a,style:{backgroundImage:`url(${e.imageUrl})`},children:e.children})},6832:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M});var a=n(9128),s=n(3766),i=n(5485),o=n(259),r=n(1638),d=n(9945),c=n(4222),m=n(9361),l=n(7338),p=n(8648),u=n(4513);const h={maxAttempts:3,initialDelay:1e3,maxDelay:1e4,backoffMultiplier:2,retryCondition:p.$d};async function C(e,t={},n){const a={...h,...t};let s,i=a.initialDelay;for(let r=1;r<=a.maxAttempts;r++)try{return{success:!0,data:await e(),attempts:r}}catch(o){const e=(0,p.KR)(o,p.By.UNKNOWN,p.MU.MEDIUM,{...n,attempt:r});s=e,u.A.logErrorWithRetry(o,{...n,attempt:r},r-1);if(!(r<a.maxAttempts&&(!a.retryCondition||a.retryCondition(e))))break;a.onRetry&&a.onRetry(r,e),r<a.maxAttempts&&(await g(i),i=Math.min(i*a.backoffMultiplier,a.maxDelay))}return{success:!1,error:s,attempts:a.maxAttempts}}function g(e){return new Promise(t=>setTimeout(t,e))}const f=()=>{const e=(0,s.d4)(e=>e.serverInfoReducer.serverInfo),t=(0,i.useRef)(!1);(0,i.useEffect)(()=>{e||t.current||b(e,t);const n=setInterval(()=>{t.current||b(e,t)},l.i3.REFRESH_INTERVAL_MS);return()=>{clearInterval(n)}},[e])},b=async(e,t)=>{t.current=!0;const n=await C(async()=>(await c.A.get(o.Y.SERVER_INFO,{timeout:l.i3.DEFAULT_TIMEOUT_MS})).data,{maxAttempts:3,initialDelay:1e3,retryCondition:e=>e.type===p.By.NETWORK||e.type===p.By.SERVER&&500!==e.code},{component:"ServerInfoService",action:"fetch_server_info"});try{if(n.success&&n.data){const e=n.data;e.status=Object.keys(e).length>0?"1":"0",r.j.dispatch(d.n.setServerInfo(e))}else if(n.error){u.A.logError(n.error,{component:"ServerInfoService",action:"fetch_server_info",attempts:n.attempts},n.error.type,n.error.severity);const e=(0,p.Qk)(n.error);m.t.ERROR(e);const t={name:"Kether.pl",map:"\u2013",players:"0",maxplayers:"0",bots:0,playerdetails:[],status:"0"};r.j.dispatch(d.n.setServerInfo(t))}}finally{t.current=!1}};var x=n(1004),j=n(7224),y=n(8135),v=n(9957),R=n(8505);const D=(0,y.sC)(function(){const e=(0,s.d4)(e=>e.serverInfoReducer.serverInfo),t=(0,v.fE)();f();const n=(0,i.useCallback)(e=>{const t=~~(e/3600),n=~~(e%3600/60),a=~~e%60;let s="";return t>0&&(s+=t+":"+(n<10?"0":"")),s+=n+":"+(a<10?"0":""),s+=""+a,s},[]),o=(0,i.useCallback)(e=>(0,R.jsx)("span",{children:n(e.duration)}),[n]),r=(0,i.useCallback)(()=>{var n;return null!==e&&void 0!==e&&null!==(n=e.playerdetails)&&void 0!==n&&n.length?(0,R.jsx)("div",{className:"player-list-table",children:(0,R.jsxs)(x.b,{value:e.playerdetails,removableSort:!0,sortMode:"multiple",scrollable:!0,children:[(0,R.jsx)(j.V,{field:"name",header:t.nickname,sortable:!0}),(0,R.jsx)(j.V,{field:"score",header:t.score,sortable:!0}),(0,R.jsx)(j.V,{body:o,header:t.duration})]})}):null},[e,o,t]);return(0,R.jsxs)("div",{className:"section future-rot",children:[(0,R.jsxs)("span",{children:[t.name,": ",null===e||void 0===e?void 0:e.name]}),(0,R.jsxs)("span",{children:["IP: ",l.Fq.IP,(0,R.jsx)(a.$,{icon:"pi pi-copy",style:{scale:"0.8",verticalAlign:"unset"},onClick:()=>{navigator.clipboard.writeText(l.Fq.IP),m.t.SUCCESS(l.PL.COPY_SUCCESS)}})]}),(0,R.jsxs)("span",{children:[t.players,": ",null===e||void 0===e?void 0:e.players,"/",null===e||void 0===e?void 0:e.maxplayers," (",null===e||void 0===e?void 0:e.bots," ",1===(null===e||void 0===e?void 0:e.bots)?t.bot:t.bots,")"]}),(0,R.jsxs)("span",{children:[t.status,": ","1"===(null===e||void 0===e?void 0:e.status)?t.online:t.offline]}),(0,R.jsxs)("span",{children:[t.map,": ",null===e||void 0===e?void 0:e.map]}),(0,R.jsx)("span",{children:(0,R.jsx)(a.$,{label:t.joinGame,onClick:()=>{window.location.href=l.Fq.STEAM_CONNECT_URL}})}),r()&&(0,R.jsx)("span",{children:r()}),(0,R.jsxs)("span",{className:"centered-text",children:[t.customMapsText,(0,R.jsx)("a",{style:{display:"inline-block",marginLeft:"10px",textDecoration:"none",color:"white",WebkitTextStroke:" 3px red"},href:"https://steamcommunity.com/sharedfiles/filedetails/?id=2542824628",children:t.here})]})]})});var S=n(3834);const k={useCommandsLoadingService:()=>{E()},getCommands:()=>fetch(`${o.Y.COMMANDS}/getCommands`,{method:"get"}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(e=>{r.j.dispatch(S.U.setCommands(e))}).catch(e=>{m.t.ERROR(`Error while fetching commands: ${e.message}`)}),addNewCommand:e=>fetch(`${o.Y.COMMANDS}/addCommand`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:e.command,description:e.description})}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(e=>(k.getCommands(),e)).catch(e=>{throw m.t.ERROR(`Error while adding new command: ${e.message}`),e}),deleteCommand:e=>fetch(`${o.Y.COMMANDS}/deleteCommand`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.id})}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(e=>(k.getCommands(),e.message)).catch(e=>{throw m.t.ERROR(`Error while deleting command: ${e.message}`),e}),updateCommand:e=>fetch(`${o.Y.COMMANDS}/updateCommand`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.id,command:e.command,description:e.description})}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(e=>(k.getCommands(),e.message)).catch(e=>{throw m.t.ERROR(`Error while updating command: ${e.message}`),e})},E=()=>{(0,i.useEffect)(()=>{k.getCommands()},[])};var N=n(6726),w=n(5129);function _(e){return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)("h5",{children:"Command"}),(0,R.jsx)(w.S,{value:e.command,onChange:t=>e.setCommand(t.target.value)}),(0,R.jsx)("h5",{children:"Description"}),(0,R.jsx)(w.S,{value:e.commandDescription,onChange:t=>e.setCommandDescription(t.target.value)})]})}function O(e){return(0,R.jsx)(N.l,{visible:e.isDialogVisible,header:"Edit Command",modal:!0,className:"p-fluid",footer:(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(a.$,{label:"Cancel",icon:"pi pi-times",className:"p-button-text",onClick:()=>{e.commandEditingIdRef.current=-1,e.setDialogVisibility(!1)}}),(0,R.jsx)(a.$,{label:"Update",icon:"pi pi-check",className:"p-button-text",onClick:()=>{const t={command:e.command,description:e.commandDescription,id:e.commandEditingIdRef.current};k.updateCommand(t).then(()=>{m.t.SUCCESS("Successfully updated the command"),e.setDialogVisibility(!1),e.commandEditingIdRef.current=-1}).catch(e=>{m.t.ERROR(`Couldn't update the command: ${e.message}`)})}})]}),onHide:()=>{e.setDialogVisibility(!1)},children:(0,R.jsx)(_,{command:e.command,commandDescription:e.commandDescription,setCommand:e.setCommand,setCommandDescription:e.setCommandDescription})})}var $=n(546);function A(e){const t=(0,v.Sx)(),n=(0,v.FC)(),s=(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(a.$,{label:n.cancel,icon:"pi pi-times",className:"p-button-text",onClick:()=>e.setDialogVisibility(!1)}),(0,R.jsx)(a.$,{label:n.save,icon:"pi pi-check",className:"p-button-text",onClick:()=>{const n={command:e.command,description:e.commandDescription};k.addNewCommand(n).then(()=>{m.t.SUCCESS(t.successfullyAdded),e.setDialogVisibility(!1),e.setCommandDescription("")}).catch(e=>{m.t.ERROR(`${t.couldntAdd}: ${e.message}`)})}})]});return(0,R.jsx)(N.l,{visible:e.isDialogVisible,header:t.addNewCommand,modal:!0,className:"p-fluid",footer:s,onHide:()=>e.setDialogVisibility(!1),children:(0,R.jsx)(_,{setCommandDescription:e.setCommandDescription,commandDescription:e.commandDescription,setCommand:e.setCommand,command:e.command})})}function T(){const e=(0,s.d4)(e=>e.userDataReducer.isAdmin),t=(0,s.d4)(e=>e.commandsReducer.commands),n=(0,v.Sx)(),[o,r]=(0,i.useState)(""),d=(0,i.useRef)(-1),[c,l]=(0,i.useState)(""),[p,u]=(0,i.useState)(!1),[h,C]=(0,i.useState)(!1);k.useCommandsLoadingService();return(0,R.jsxs)("div",{className:"section",children:[(0,R.jsx)(A,{setCommandDescription:r,commandDescription:o,setCommand:l,command:c,isDialogVisible:p,setDialogVisibility:u}),(0,R.jsx)(O,{setCommandDescription:r,commandDescription:o,setCommand:l,command:c,commandEditingIdRef:d,isDialogVisible:h,setDialogVisibility:C}),e&&(0,R.jsx)($.M,{className:"mb-4",start:(0,R.jsx)(R.Fragment,{children:e&&(0,R.jsx)(a.$,{label:n.newCommand,icon:"pi pi-plus",className:"mr-2","data-toggle":"tooltip",title:n.addNewCommandTooltip,onClick:()=>u(!0)})})}),(0,R.jsxs)(x.b,{value:t,responsiveLayout:"scroll",style:{backgroundColor:"transparent",background:"transparent",backdropFilter:"blur(2px)"},children:[(0,R.jsx)(j.V,{field:"command",header:"Command"}),(0,R.jsx)(j.V,{field:"description",header:"Description"}),e&&(0,R.jsx)(j.V,{header:"Actions",body:e=>(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(a.$,{"data-toggle":"tooltip",title:"Edits the given command",icon:"pi pi-pencil",className:"p-button-rounded mr-2",onClick:()=>{d.current=e.id,C(!0),l(e.command),r(e.description)}}),(0,R.jsx)(a.$,{"data-toggle":"tooltip",title:"Deletes the given command instantly",icon:"pi pi-trash",className:"p-button-rounded p-button-danger",onClick:()=>{k.deleteCommand(e).then(e=>{m.t.SUCCESS(`${e}`),u(!1),r("")}).catch(e=>{m.t.ERROR(`Couldn't delete the command: ${e}`)})}})]})})]})]})}var I=n(5475),U=n(7020);function M(){return(0,R.jsx)(I.K,{imageUrl:U.Y.BACKGROUND_1,children:(0,R.jsxs)("div",{className:"home-page",children:[(0,R.jsx)(D,{}),(0,R.jsx)(T,{})]})})}},7020:(e,t,n)=>{n.d(t,{Y:()=>m});const a=n.p+"static/media/background_1.bbbbf33c0f3cf7222559.jpg",s=n.p+"static/media/background_2.7713c83c2427f6bd817f.jpg",i=n.p+"static/media/background_3.4e932a7e40bb7c3fc904.jpg",o=n.p+"static/media/background_4.afd7ff29b91152c81d22.jpg",r=n.p+"static/media/background_5.4d636ab7f678d71f2368.jpg",d=n.p+"static/media/background_6.941575f694ad75fbd537.jpg",c=e=>`${e}`,m={BACKGROUND_1:c(a),BACKGROUND_2:c(s),BACKGROUND_3:c(i),BACKGROUND_4:c(o),BACKGROUND_5:c(r),BACKGROUND_6:c(d)}}}]);