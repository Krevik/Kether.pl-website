"use strict";(globalThis.webpackChunkkether_pl=globalThis.webpackChunkkether_pl||[]).push([[641],{5475:(e,t,a)=>{a.d(t,{K:()=>o});const n="PageWithBackground_pageWithBackground__nL8hr";a(5485);var s=a(8505);const o=e=>(0,s.jsx)("div",{className:n,style:{backgroundImage:`url(${e.imageUrl})`},children:e.children})},6832:(e,t,a)=>{a.r(t),a.d(t,{default:()=>U});var n=a(9128),s=a(3766),o=a(5485),i=a(259),r=a(1638),d=a(9945),c=a(4222),m=a(9361),l=a(7338),p=a(8648),u=a(4513);const h={maxAttempts:3,initialDelay:1e3,maxDelay:1e4,backoffMultiplier:2,retryCondition:p.$d};async function C(e,t={},a){const n={...h,...t};let s,o=n.initialDelay;for(let r=1;r<=n.maxAttempts;r++)try{return{success:!0,data:await e(),attempts:r}}catch(i){const e=(0,p.KR)(i,p.By.UNKNOWN,p.MU.MEDIUM,{...a,attempt:r});s=e,u.A.logErrorWithRetry(i,{...a,attempt:r},r-1);if(!(r<n.maxAttempts&&(!n.retryCondition||n.retryCondition(e))))break;n.onRetry&&n.onRetry(r,e),r<n.maxAttempts&&(await g(o),o=Math.min(o*n.backoffMultiplier,n.maxDelay))}return{success:!1,error:s,attempts:n.maxAttempts}}function g(e){return new Promise(t=>setTimeout(t,e))}const f=()=>{const e=(0,s.d4)(e=>e.serverInfoReducer.serverInfo),t=(0,o.useRef)(!1);(0,o.useEffect)(()=>{e||t.current||b(e,t);const a=setInterval(()=>{t.current||b(e,t)},l.i3.REFRESH_INTERVAL_MS);return()=>{clearInterval(a)}},[e])},b=async(e,t)=>{t.current=!0;const a=await C(async()=>(await c.A.get(i.Y.SERVER_INFO,{timeout:l.i3.DEFAULT_TIMEOUT_MS})).data,{maxAttempts:3,initialDelay:1e3,retryCondition:e=>e.type===p.By.NETWORK||e.type===p.By.SERVER&&500!==e.code},{component:"ServerInfoService",action:"fetch_server_info"});try{if(a.success&&a.data){const e=a.data;e.status=Object.keys(e).length>0?"1":"0",r.j.dispatch(d.n.setServerInfo(e))}else if(a.error){u.A.logError(a.error,{component:"ServerInfoService",action:"fetch_server_info",attempts:a.attempts},a.error.type,a.error.severity);const e=(0,p.Qk)(a.error);m.t.ERROR(e);const t={name:"Kether.pl",map:"\u2013",players:"0",maxplayers:"0",bots:0,playerdetails:[],status:"0"};r.j.dispatch(d.n.setServerInfo(t))}}finally{t.current=!1}};var x=a(1004),j=a(7224),y=a(8135),v=a(9957),R=a(8505);const D=(0,y.sC)(function(){const e=(0,s.d4)(e=>e.serverInfoReducer.serverInfo),t=(0,v.fE)();f();const a=(0,o.useCallback)(e=>{const t=~~(e/3600),a=~~(e%3600/60),n=~~e%60;let s="";return t>0&&(s+=t+":"+(a<10?"0":"")),s+=a+":"+(n<10?"0":""),s+=""+n,s},[]),i=(0,o.useCallback)(e=>(0,R.jsx)("span",{children:a(e.duration)}),[a]),r=(0,o.useCallback)(()=>{var a;return null!==e&&void 0!==e&&null!==(a=e.playerdetails)&&void 0!==a&&a.length?(0,R.jsx)("div",{className:"player-list-table",children:(0,R.jsxs)(x.b,{value:e.playerdetails,removableSort:!0,sortMode:"multiple",scrollable:!0,emptyMessage:t.noPlayersAvailable,children:[(0,R.jsx)(j.V,{field:"name",header:t.nickname,sortable:!0}),(0,R.jsx)(j.V,{field:"score",header:t.score,sortable:!0}),(0,R.jsx)(j.V,{body:i,header:t.duration})]})}):null},[e,i,t]);return(0,R.jsxs)("div",{className:"section future-rot",children:[(0,R.jsxs)("span",{children:[t.name,": ",null===e||void 0===e?void 0:e.name]}),(0,R.jsxs)("span",{children:["IP: ",l.Fq.IP,(0,R.jsx)(n.$,{icon:"pi pi-copy",style:{scale:"0.8",verticalAlign:"unset"},onClick:()=>{navigator.clipboard.writeText(l.Fq.IP),m.t.SUCCESS(l.PL.COPY_SUCCESS)}})]}),(0,R.jsxs)("span",{children:[t.players,": ",null===e||void 0===e?void 0:e.players,"/",null===e||void 0===e?void 0:e.maxplayers," (",null===e||void 0===e?void 0:e.bots," ",1===(null===e||void 0===e?void 0:e.bots)?t.bot:t.bots,")"]}),(0,R.jsxs)("span",{children:[t.status,": ","1"===(null===e||void 0===e?void 0:e.status)?t.online:t.offline]}),(0,R.jsxs)("span",{children:[t.map,": ",null===e||void 0===e?void 0:e.map]}),(0,R.jsx)("span",{children:(0,R.jsx)(n.$,{label:t.joinGame,onClick:()=>{window.location.href=l.Fq.STEAM_CONNECT_URL}})}),r()&&(0,R.jsx)("span",{children:r()}),(0,R.jsxs)("span",{className:"centered-text",children:[t.customMapsText,(0,R.jsx)("a",{style:{display:"inline-block",marginLeft:"10px",textDecoration:"none",color:"white",WebkitTextStroke:" 3px red"},href:"https://steamcommunity.com/sharedfiles/filedetails/?id=2542824628",children:t.here})]})]})});var S=a(3834);const k={useCommandsLoadingService:()=>{E()},getCommands:()=>fetch(`${i.Y.COMMANDS}/getCommands`,{method:"get"}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(e=>{r.j.dispatch(S.U.setCommands(e))}).catch(e=>{m.t.ERROR(`Error while fetching commands: ${e.message}`)}),addNewCommand:e=>fetch(`${i.Y.COMMANDS}/addCommand`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:e.command,description:e.description})}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(e=>(k.getCommands(),e)).catch(e=>{throw m.t.ERROR(`Error while adding new command: ${e.message}`),e}),deleteCommand:e=>fetch(`${i.Y.COMMANDS}/deleteCommand`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.id})}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(e=>(k.getCommands(),e.message)).catch(e=>{throw m.t.ERROR(`Error while deleting command: ${e.message}`),e}),updateCommand:e=>fetch(`${i.Y.COMMANDS}/updateCommand`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.id,command:e.command,description:e.description})}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(e=>(k.getCommands(),e.message)).catch(e=>{throw m.t.ERROR(`Error while updating command: ${e.message}`),e})},E=()=>{(0,o.useEffect)(()=>{k.getCommands()},[])};var N=a(6726),w=a(5129);function $(e){return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)("h5",{children:"Command"}),(0,R.jsx)(w.S,{value:e.command,onChange:t=>e.setCommand(t.target.value)}),(0,R.jsx)("h5",{children:"Description"}),(0,R.jsx)(w.S,{value:e.commandDescription,onChange:t=>e.setCommandDescription(t.target.value)})]})}function _(e){const t=(0,v.Sx)(),a=(0,v.FC)();return(0,R.jsx)(N.l,{visible:e.isDialogVisible,header:t.editCommand,modal:!0,className:"p-fluid",footer:(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(n.$,{label:a.cancel,icon:"pi pi-times",className:"p-button-text",onClick:()=>{e.commandEditingIdRef.current=-1,e.setDialogVisibility(!1)}}),(0,R.jsx)(n.$,{label:a.update,icon:"pi pi-check",className:"p-button-text",onClick:()=>{const t={command:e.command,description:e.commandDescription,id:e.commandEditingIdRef.current};k.updateCommand(t).then(()=>{m.t.SUCCESS("Successfully updated the command"),e.setDialogVisibility(!1),e.commandEditingIdRef.current=-1}).catch(e=>{m.t.ERROR(`Couldn't update the command: ${e.message}`)})}})]}),onHide:()=>{e.setDialogVisibility(!1)},children:(0,R.jsx)($,{command:e.command,commandDescription:e.commandDescription,setCommand:e.setCommand,setCommandDescription:e.setCommandDescription})})}var A=a(546);function O(e){const t=(0,v.Sx)(),a=(0,v.FC)(),s=(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(n.$,{label:a.cancel,icon:"pi pi-times",className:"p-button-text",onClick:()=>e.setDialogVisibility(!1)}),(0,R.jsx)(n.$,{label:a.save,icon:"pi pi-check",className:"p-button-text",onClick:()=>{const a={command:e.command,description:e.commandDescription};k.addNewCommand(a).then(()=>{m.t.SUCCESS(t.successfullyAdded),e.setDialogVisibility(!1),e.setCommandDescription("")}).catch(e=>{m.t.ERROR(`${t.couldntAdd}: ${e.message}`)})}})]});return(0,R.jsx)(N.l,{visible:e.isDialogVisible,header:t.addNewCommand,modal:!0,className:"p-fluid",footer:s,onHide:()=>e.setDialogVisibility(!1),children:(0,R.jsx)($,{setCommandDescription:e.setCommandDescription,commandDescription:e.commandDescription,setCommand:e.setCommand,command:e.command})})}function T(){const e=(0,s.d4)(e=>e.userDataReducer.isAdmin),t=(0,s.d4)(e=>e.commandsReducer.commands),a=(0,v.Sx)(),[i,r]=(0,o.useState)(""),d=(0,o.useRef)(-1),[c,l]=(0,o.useState)(""),[p,u]=(0,o.useState)(!1),[h,C]=(0,o.useState)(!1);k.useCommandsLoadingService();return(0,R.jsxs)("div",{className:"section",children:[(0,R.jsx)(O,{setCommandDescription:r,commandDescription:i,setCommand:l,command:c,isDialogVisible:p,setDialogVisibility:u}),(0,R.jsx)(_,{setCommandDescription:r,commandDescription:i,setCommand:l,command:c,commandEditingIdRef:d,isDialogVisible:h,setDialogVisibility:C}),e&&(0,R.jsx)(A.M,{className:"mb-4",start:(0,R.jsx)(R.Fragment,{children:e&&(0,R.jsx)(n.$,{label:a.newCommand,icon:"pi pi-plus",className:"mr-2","data-toggle":"tooltip",title:a.addNewCommandTooltip,onClick:()=>u(!0)})})}),(0,R.jsxs)(x.b,{value:t,responsiveLayout:"scroll",style:{backgroundColor:"transparent",background:"transparent",backdropFilter:"blur(2px)"},emptyMessage:a.noCommandsAvailable,children:[(0,R.jsx)(j.V,{field:"command",header:a.command}),(0,R.jsx)(j.V,{field:"description",header:a.description}),e&&(0,R.jsx)(j.V,{header:a.actions,body:e=>(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(n.$,{"data-toggle":"tooltip",title:a.editCommandTooltip,icon:"pi pi-pencil",className:"p-button-rounded mr-2",onClick:()=>{d.current=e.id,C(!0),l(e.command),r(e.description)}}),(0,R.jsx)(n.$,{"data-toggle":"tooltip",title:a.deleteCommandTooltip,icon:"pi pi-trash",className:"p-button-rounded p-button-danger",onClick:()=>{k.deleteCommand(e).then(e=>{m.t.SUCCESS(`${e}`),u(!1),r("")}).catch(e=>{m.t.ERROR(`${a.couldntDelete}: ${e}`)})}})]})})]})]})}var M=a(5475),I=a(7020);function U(){return(0,R.jsx)(M.K,{imageUrl:I.Y.BACKGROUND_1,children:(0,R.jsxs)("div",{className:"home-page",children:[(0,R.jsx)(D,{}),(0,R.jsx)(T,{})]})})}},7020:(e,t,a)=>{a.d(t,{Y:()=>m});const n=a.p+"static/media/background_1.bbbbf33c0f3cf7222559.jpg",s=a.p+"static/media/background_2.7713c83c2427f6bd817f.jpg",o=a.p+"static/media/background_3.4e932a7e40bb7c3fc904.jpg",i=a.p+"static/media/background_4.afd7ff29b91152c81d22.jpg",r=a.p+"static/media/background_5.4d636ab7f678d71f2368.jpg",d=a.p+"static/media/background_6.941575f694ad75fbd537.jpg",c=e=>`${e}`,m={BACKGROUND_1:c(n),BACKGROUND_2:c(s),BACKGROUND_3:c(o),BACKGROUND_4:c(i),BACKGROUND_5:c(r),BACKGROUND_6:c(d)}}}]);