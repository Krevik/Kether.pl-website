"use strict";(globalThis.webpackChunkkether_pl=globalThis.webpackChunkkether_pl||[]).push([[978],{978:(e,t,n)=>{n.r(t),n.d(t,{default:()=>I});var s=n(3678),a=n(3532),o=n(6811),i=n(6397),r=n(5569),c=n(2755),d=n(3375),l=n(9580),m=n(7514),p=n(9299);const u={maxAttempts:3,initialDelay:1e3,maxDelay:1e4,backoffMultiplier:2,retryCondition:m.$d};async function h(e,t={},n){const s={...u,...t};let a,o=s.initialDelay;for(let r=1;r<=s.maxAttempts;r++)try{return{success:!0,data:await e(),attempts:r}}catch(i){const e=(0,m.KR)(i,m.By.UNKNOWN,m.MU.MEDIUM,{...n,attempt:r});a=e,p.A.logErrorWithRetry(i,{...n,attempt:r},r-1);if(!(r<s.maxAttempts&&(!s.retryCondition||s.retryCondition(e))))break;s.onRetry&&s.onRetry(r,e),r<s.maxAttempts&&(await C(o),o=Math.min(o*s.backoffMultiplier,s.maxDelay))}return{success:!1,error:a,attempts:s.maxAttempts}}function C(e){return new Promise(t=>setTimeout(t,e))}const g=()=>{const e=(0,a.d4)(e=>e.serverInfoReducer.serverInfo),t=(0,o.useRef)(!1);(0,o.useEffect)(()=>{e||t.current||f(e,t);const n=setInterval(()=>{t.current||f(e,t)},l.i3.REFRESH_INTERVAL_MS);return()=>{clearInterval(n)}},[e])},f=async(e,t)=>{t.current=!0;const n=await h(async()=>{const e=new AbortController,t=setTimeout(()=>e.abort(),l.i3.DEFAULT_TIMEOUT_MS);try{const n=await fetch(i.Y.SERVER_INFO,{signal:e.signal});if(clearTimeout(t),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);return await n.json()}catch(n){throw clearTimeout(t),n}},{maxAttempts:3,initialDelay:1e3,retryCondition:e=>e.type===m.By.NETWORK||e.type===m.By.SERVER&&500!==e.code},{component:"ServerInfoService",action:"fetch_server_info"});try{if(n.success&&n.data){const e=n.data;e.status=Object.keys(e).length>0?"1":"0",r.j.dispatch(c.n.setServerInfo(e))}else if(n.error){p.A.logError(n.error,{component:"ServerInfoService",action:"fetch_server_info",attempts:n.attempts},n.error.type,n.error.severity);const e=(0,m.Qk)(n.error);d.t.ERROR(e);const t={name:"Kether.pl",map:"\u2013",players:"0",maxplayers:"0",bots:0,playerdetails:[],status:"0"};r.j.dispatch(c.n.setServerInfo(t))}}finally{t.current=!1}};var b=n(4177),x=n(9638),j=n(2637),y=n(8663),v=n(7963);const R=(0,j.sC)(function(){const e=(0,a.d4)(e=>e.serverInfoReducer.serverInfo),t=(0,y.fE)();g();const n=(0,o.useCallback)(e=>{const t=~~(e/3600),n=~~(e%3600/60),s=~~e%60;let a="";return t>0&&(a+=t+":"+(n<10?"0":"")),a+=n+":"+(s<10?"0":""),a+=""+s,a},[]),i=(0,o.useCallback)(e=>(0,v.jsx)("span",{children:n(e.duration)}),[n]),r=(0,o.useCallback)(()=>{var n;return null!==e&&void 0!==e&&null!==(n=e.playerdetails)&&void 0!==n&&n.length?(0,v.jsx)("div",{className:"player-list-table",children:(0,v.jsxs)(b.b,{value:e.playerdetails,removableSort:!0,sortMode:"multiple",scrollable:!0,emptyMessage:t.noPlayersAvailable,children:[(0,v.jsx)(x.V,{field:"name",header:t.nickname,sortable:!0}),(0,v.jsx)(x.V,{field:"score",header:t.score,sortable:!0}),(0,v.jsx)(x.V,{body:i,header:t.duration})]})}):null},[e,i,t]);return(0,v.jsxs)("div",{className:"section future-rot",children:[(0,v.jsxs)("span",{children:[t.name,": ",null===e||void 0===e?void 0:e.name]}),(0,v.jsxs)("span",{children:["IP: ",l.Fq.IP,(0,v.jsx)(s.$,{icon:"pi pi-copy",style:{scale:"0.8",verticalAlign:"unset"},onClick:()=>{navigator.clipboard.writeText(l.Fq.IP),d.t.SUCCESS(l.PL.COPY_SUCCESS)}})]}),(0,v.jsxs)("span",{children:[t.players,": ",null===e||void 0===e?void 0:e.players,"/",null===e||void 0===e?void 0:e.maxplayers," (",null===e||void 0===e?void 0:e.bots," ",1===(null===e||void 0===e?void 0:e.bots)?t.bot:t.bots,")"]}),(0,v.jsxs)("span",{children:[t.status,": ","1"===(null===e||void 0===e?void 0:e.status)?t.online:t.offline]}),(0,v.jsxs)("span",{children:[t.map,": ",null===e||void 0===e?void 0:e.map]}),(0,v.jsx)("span",{children:(0,v.jsx)(s.$,{label:t.joinGame,onClick:()=>{window.location.href=l.Fq.STEAM_CONNECT_URL}})}),r()&&(0,v.jsx)("span",{children:r()}),(0,v.jsxs)("span",{className:"centered-text",children:[t.customMapsText,(0,v.jsx)("a",{style:{display:"inline-block",marginLeft:"10px",textDecoration:"none",color:"white",WebkitTextStroke:" 3px red"},href:"https://steamcommunity.com/sharedfiles/filedetails/?id=2542824628",children:t.here})]})]})});var D=n(3520);const S={useCommandsLoadingService:()=>{k()},getCommands:()=>fetch(`${i.Y.COMMANDS}/getCommands`,{method:"get"}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(e=>{r.j.dispatch(D.U.setCommands(e))}).catch(e=>{d.t.ERROR(`Error while fetching commands: ${e.message}`)}),addNewCommand:e=>fetch(`${i.Y.COMMANDS}/addCommand`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:e.command,description:e.description})}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(e=>(S.getCommands(),e)).catch(e=>{throw d.t.ERROR(`Error while adding new command: ${e.message}`),e}),deleteCommand:e=>fetch(`${i.Y.COMMANDS}/deleteCommand`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.id})}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(e=>(S.getCommands(),e.message)).catch(e=>{throw d.t.ERROR(`Error while deleting command: ${e.message}`),e}),updateCommand:e=>fetch(`${i.Y.COMMANDS}/updateCommand`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.id,command:e.command,description:e.description})}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(e=>(S.getCommands(),e.message)).catch(e=>{throw d.t.ERROR(`Error while updating command: ${e.message}`),e})},k=()=>{(0,o.useEffect)(()=>{S.getCommands()},[])};var E=n(6915),N=n(4843);function w(e){return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("h5",{children:"Command"}),(0,v.jsx)(N.S,{value:e.command,onChange:t=>e.setCommand(t.target.value)}),(0,v.jsx)("h5",{children:"Description"}),(0,v.jsx)(N.S,{value:e.commandDescription,onChange:t=>e.setCommandDescription(t.target.value)})]})}function T(e){const t=(0,y.Sx)(),n=(0,y.FC)();return(0,v.jsx)(E.l,{visible:e.isDialogVisible,header:t.editCommand,modal:!0,className:"p-fluid",footer:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(s.$,{label:n.cancel,icon:"pi pi-times",className:"p-button-text",onClick:()=>{e.commandEditingIdRef.current=-1,e.setDialogVisibility(!1)}}),(0,v.jsx)(s.$,{label:n.update,icon:"pi pi-check",className:"p-button-text",onClick:()=>{const t={command:e.command,description:e.commandDescription,id:e.commandEditingIdRef.current};S.updateCommand(t).then(()=>{d.t.SUCCESS("Successfully updated the command"),e.setDialogVisibility(!1),e.commandEditingIdRef.current=-1}).catch(e=>{d.t.ERROR(`Couldn't update the command: ${e.message}`)})}})]}),onHide:()=>{e.setDialogVisibility(!1)},children:(0,v.jsx)(w,{command:e.command,commandDescription:e.commandDescription,setCommand:e.setCommand,setCommandDescription:e.setCommandDescription})})}var $=n(4400);function _(e){const t=(0,y.Sx)(),n=(0,y.FC)(),a=(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(s.$,{label:n.cancel,icon:"pi pi-times",className:"p-button-text",onClick:()=>e.setDialogVisibility(!1)}),(0,v.jsx)(s.$,{label:n.save,icon:"pi pi-check",className:"p-button-text",onClick:()=>{const n={command:e.command,description:e.commandDescription};S.addNewCommand(n).then(()=>{d.t.SUCCESS(t.successfullyAdded),e.setDialogVisibility(!1),e.setCommandDescription("")}).catch(e=>{d.t.ERROR(`${t.couldntAdd}: ${e.message}`)})}})]});return(0,v.jsx)(E.l,{visible:e.isDialogVisible,header:t.addNewCommand,modal:!0,className:"p-fluid",footer:a,onHide:()=>e.setDialogVisibility(!1),children:(0,v.jsx)(w,{setCommandDescription:e.setCommandDescription,commandDescription:e.commandDescription,setCommand:e.setCommand,command:e.command})})}function A(){const e=(0,a.d4)(e=>e.userDataReducer.isAdmin),t=(0,a.d4)(e=>e.commandsReducer.commands),n=(0,y.Sx)(),[i,r]=(0,o.useState)(""),c=(0,o.useRef)(-1),[l,m]=(0,o.useState)(""),[p,u]=(0,o.useState)(!1),[h,C]=(0,o.useState)(!1);S.useCommandsLoadingService();return(0,v.jsxs)("div",{className:"section",children:[(0,v.jsx)(_,{setCommandDescription:r,commandDescription:i,setCommand:m,command:l,isDialogVisible:p,setDialogVisibility:u}),(0,v.jsx)(T,{setCommandDescription:r,commandDescription:i,setCommand:m,command:l,commandEditingIdRef:c,isDialogVisible:h,setDialogVisibility:C}),e&&(0,v.jsx)($.M,{className:"mb-4",start:(0,v.jsx)(v.Fragment,{children:e&&(0,v.jsx)(s.$,{label:n.newCommand,icon:"pi pi-plus",className:"mr-2","data-toggle":"tooltip",title:n.addNewCommandTooltip,onClick:()=>u(!0)})})}),(0,v.jsxs)(b.b,{value:t,responsiveLayout:"scroll",style:{backgroundColor:"transparent",background:"transparent",backdropFilter:"blur(2px)"},emptyMessage:n.noCommandsAvailable,children:[(0,v.jsx)(x.V,{field:"command",header:n.command}),(0,v.jsx)(x.V,{field:"description",header:n.description}),e&&(0,v.jsx)(x.V,{header:n.actions,body:e=>(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(s.$,{"data-toggle":"tooltip",title:n.editCommandTooltip,icon:"pi pi-pencil",className:"p-button-rounded mr-2",onClick:()=>{c.current=e.id,C(!0),m(e.command),r(e.description)}}),(0,v.jsx)(s.$,{"data-toggle":"tooltip",title:n.deleteCommandTooltip,icon:"pi pi-trash",className:"p-button-rounded p-button-danger",onClick:()=>{S.deleteCommand(e).then(e=>{d.t.SUCCESS(`${e}`),u(!1),r("")}).catch(e=>{d.t.ERROR(`${n.couldntDelete}: ${e}`)})}})]})})]})]})}var O=n(4859),M=n(2847);function I(){return(0,v.jsx)(O.K,{imageUrl:M.Y.BACKGROUND_1,children:(0,v.jsxs)("div",{className:"home-page",children:[(0,v.jsx)(R,{}),(0,v.jsx)(A,{})]})})}},1382:(e,t,n)=>{e.exports=n.p+"static/media/background_3.4e932a7e40bb7c3fc904.jpg"},2847:(e,t,n)=>{n.d(t,{Y:()=>s});const s={BACKGROUND_1:n(2916),BACKGROUND_2:n(4547),BACKGROUND_3:n(1382),BACKGROUND_4:n(9197),BACKGROUND_5:n(3616),BACKGROUND_6:n(7231)}},2916:(e,t,n)=>{e.exports=n.p+"static/media/background_1.bbbbf33c0f3cf7222559.jpg"},3616:(e,t,n)=>{e.exports=n.p+"static/media/background_5.4d636ab7f678d71f2368.jpg"},4547:(e,t,n)=>{e.exports=n.p+"static/media/background_2.7713c83c2427f6bd817f.jpg"},4859:(e,t,n)=>{n.d(t,{K:()=>o});const s="PageWithBackground_pageWithBackground__nL8hr";n(6811);var a=n(7963);const o=e=>(0,a.jsx)("div",{className:s,style:{backgroundImage:`url(${e.imageUrl})`},children:e.children})},7231:(e,t,n)=>{e.exports=n.p+"static/media/background_6.941575f694ad75fbd537.jpg"},9197:(e,t,n)=>{e.exports=n.p+"static/media/background_4.afd7ff29b91152c81d22.jpg"}}]);