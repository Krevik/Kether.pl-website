"use strict";(globalThis.webpackChunkkether_pl=globalThis.webpackChunkkether_pl||[]).push([[478],{1114:(t,e,i)=>{i.d(e,{h:()=>n});let n=function(t){return t.UPVOTE="Upvote",t.DOWNVOTE="Downvote",t}({})},2763:(t,e,i)=>{i.d(e,{O:()=>u});var n=i(5485),o=i(1114),s=i(1638),d=i(7766),a=i(259),r=i(3766),l=i(3223),c=i(9361);const u={useBindsLoadingService:t=>g(t||void 0),getBinds:t=>fetch(`${l.o}${a.T.API_BASE_PATH}${a.T.BINDS_PATH}/getBinds`,{method:"get"}).then(t=>{if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t.json()}).then(e=>h().then(i=>{var n;let a=[];t&&(a=i.filter(e=>e.voterSteamID===t));const r=[];null===i||void 0===i||i.forEach(t=>{const e="Upvote"===t.vote?o.h.UPVOTE:o.h.DOWNVOTE,i=e===o.h.UPVOTE,n=e===o.h.DOWNVOTE,s=r.find(e=>e.attachedBindID===Number(t.votedBindID));if(s)i&&s.Upvotes++,n&&s.Downvotes++;else{const e={id:Number(t.votedBindID),attachedBindID:Number(t.votedBindID),Upvotes:i?1:0,Downvotes:n?1:0};r.push(e)}}),null===r||void 0===r||r.forEach(t=>{const i=e.find(e=>e.id===t.attachedBindID);i&&(i.votingData=t)}),null===(n=a)||void 0===n||n.forEach(t=>{const i=e.find(e=>e.id===Number(t.votedBindID));i&&(i.votingData.selfVote=t.vote)}),s.j.dispatch(d.E.setBinds(e))})).catch(t=>{c.t.ERROR(`Error while fetching binds: ${t.message}`)}),setVote:(t,e)=>{const i=new URLSearchParams({voterSteamID:t.voterSteamID,votedBindID:t.votedBindID,vote:t.vote});return t.id&&i.set("id",t.id.toString()),fetch(`${l.o}${a.T.API_BASE_PATH}${a.T.BIND_VOTES_PATH}/${e?"deleteBindVoting":"addBindVoting"}`,{method:"post",body:i}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return u.getBinds(t.voterSteamID),e.text()}).catch(t=>{throw c.t.ERROR(`Error while setting vote: ${t.message}`),t})},addNewBind:(t,e)=>fetch(`${l.o}${a.T.API_BASE_PATH}${a.T.BINDS_PATH}/addBind`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({author:t.author,text:t.text})}).then(t=>{if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return u.getBinds(e),t.json()}).catch(t=>{throw c.t.ERROR(`Error while adding new bind: ${t.message}`),t}),deleteBind:(t,e)=>fetch(`${l.o}${a.T.API_BASE_PATH}${a.T.BINDS_PATH}/deleteBind`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t.id})}).then(t=>{if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t.json()}).then(t=>(u.getBinds(e),t.message)).catch(t=>{throw c.t.ERROR(`Error while deleting bind: ${t.message}`),t}),updateBind:(t,e)=>fetch(`${l.o}${a.T.API_BASE_PATH}${a.T.BINDS_PATH}/updateBind`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t.id,author:`${t.author}`,text:`${t.text}`})}).then(t=>{if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t.json()}).then(t=>(u.getBinds(e),t.message)).catch(t=>{throw c.t.ERROR(`Error while updating bind: ${t.message}`),t})},h=()=>fetch(`${l.o}${a.T.API_BASE_PATH}${a.T.BIND_VOTES_PATH}/getBindVotings`,{method:"get"}).then(t=>{if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t.json()}).catch(t=>(c.t.ERROR(`Error while fetching bind votes: ${t.message}`),[])),g=t=>{const e=(0,r.d4)(t=>t.userDataReducer.userData),[i,o]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{o(!0),u.getBinds(t).finally(()=>{o(!1)})},[e,t]),i}},5475:(t,e,i)=>{i.d(e,{K:()=>s});const n="PageWithBackground_pageWithBackground__nL8hr";i(5485);var o=i(8505);const s=t=>(0,o.jsx)("div",{className:n,style:{backgroundImage:`url(${t.imageUrl})`},children:t.children})},6039:(t,e,i)=>{i.r(e),i.d(e,{default:()=>O});var n=i(7224),o=i(1004),s=i(3766),d=i(2763),a=i(9128),r=i(1114),l=i(5485),c=i(546),u=i(9361),h=i(6726),g=i(9230),b=i(9957),p=i(8505);function v(t){const e=(0,b.sz)(),i=(0,b.FC)();return(0,p.jsx)(h.l,{visible:t.isDialogVisible,header:e.editBind,modal:!0,className:"p-fluid",footer:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(a.$,{label:i.cancel,icon:"pi pi-times",className:"p-button-text",onClick:()=>{t.bindEditingIdRef.current=-1,t.setDialogVisibility(!1)}}),(0,p.jsx)(a.$,{label:i.update,icon:"pi pi-check",className:"p-button-text",onClick:()=>{const e={author:t.bindAuthor,text:t.bindText,id:t.bindEditingIdRef.current};d.O.updateBind(e).then(()=>{u.t.SUCCESS("Successfully updated the bind"),t.setDialogVisibility(!1),t.bindEditingIdRef.current=-1}).catch(t=>{u.t.ERROR(`Couldn't update the bind: ${t}`)})}})]}),onHide:()=>{t.setDialogVisibility(!1)},children:(0,p.jsx)(g.A,{bindAuthor:t.bindAuthor,bindText:t.bindText,setBindAuthor:t.setBindAuthor,setBindText:t.setBindText})})}function m(t){const e=(0,b.sz)(),i=(0,b.FC)(),n=(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(a.$,{label:i.cancel,icon:"pi pi-times",className:"p-button-text",onClick:()=>t.setDialogVisibility(!1)}),(0,p.jsx)(a.$,{label:i.save,icon:"pi pi-check",className:"p-button-text",onClick:()=>{const i={author:t.bindAuthor,text:t.bindText};d.O.addNewBind(i).then(()=>{u.t.SUCCESS(e.successfullyAdded),t.setDialogVisibility(!1),t.setBindText("")}).catch(t=>{u.t.ERROR(`${e.couldntAdd}: ${t}`)})}})]});return(0,p.jsx)(h.l,{visible:t.isDialogVisible,header:e.addNewBind,modal:!0,className:"p-fluid",footer:n,onHide:()=>t.setDialogVisibility(!1),children:(0,p.jsx)(g.A,{setBindText:t.setBindText,bindText:t.bindText,setBindAuthor:t.setBindAuthor,bindAuthor:t.bindAuthor})})}var T=i(5475),B=i(7020),x=i(9987);const f=t=>t.map(t=>({...t,author:`${t.author} : `})),A=(t,e,i)=>(0,p.jsx)(p.Fragment,{children:t&&(0,p.jsx)(a.$,{label:i.newBind,icon:"pi pi-plus",className:"p-button-success mr-2","data-toggle":"tooltip",title:i.addNewBindTooltip,onClick:()=>e(!0)})}),E=(t,e,i,n,o,s,r)=>(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(a.$,{"data-toggle":"tooltip",title:r.editBindTooltip,icon:"pi pi-pencil",className:"p-button-rounded p-button-warning mr-2",onClick:()=>{o.current=t.id,e(!0),i((0,x.f)(t).author),n(t.text)}}),(0,p.jsx)(a.$,{"data-toggle":"tooltip",title:r.deleteBindTooltip,icon:"pi pi-trash",className:"p-button-rounded p-button-danger",onClick:()=>{d.O.deleteBind(t,null===s||void 0===s?void 0:s.steamid).then(t=>{u.t.SUCCESS(`${t}`)}).catch(t=>{u.t.ERROR(`${r.couldntDelete}: ${t}`)})}})]}),D=(t,e,i,n)=>{var o;const s={voterSteamID:null===i||void 0===i?void 0:i.steamid,votedBindID:e.id.toString(),vote:t};s.id=(null===(o=e.votingData)||void 0===o?void 0:o.id)||void 0,d.O.setVote(s,n).then(t=>{u.t.SUCCESS(t)}).catch(t=>{u.t.ERROR(t)})},j=(t,e)=>{var i,n,o;const s=null===(i=t.votingData)||void 0===i?void 0:i.selfVote,d=`vote-up-button ${s&&s===r.h.UPVOTE?"self-voted":""}`,l=`vote-down-button ${s&&s===r.h.DOWNVOTE?"self-voted":""}`;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(a.$,{className:d,icon:"pi pi-thumbs-up",onClick:()=>{D(r.h.UPVOTE,t,e,s&&s===r.h.UPVOTE)},children:(null===(n=t.votingData)||void 0===n?void 0:n.Upvotes)||0}),(0,p.jsx)(a.$,{className:l,icon:"pi pi-thumbs-down",onClick:()=>{D(r.h.DOWNVOTE,t,e,s&&s===r.h.DOWNVOTE)},children:(null===(o=t.votingData)||void 0===o?void 0:o.Downvotes)||0})]})};function O(){const t=(0,s.d4)(t=>t.bindsReducer.binds),e=(0,b.sz)(),i=(0,s.d4)(t=>t.userDataReducer.isAdmin),a=(0,s.d4)(t=>t.userDataReducer.userData),r=(0,s.d4)(t=>t.userDataReducer.userID),[u,h]=(0,l.useState)(!1),[g,x]=(0,l.useState)(!1),[D,O]=(0,l.useState)(""),N=(0,l.useRef)(-1),[$,R]=(0,l.useState)(""),S=d.O.useBindsLoadingService(null===a||void 0===a?void 0:a.steamid);return(0,p.jsx)(T.K,{imageUrl:B.Y.BACKGROUND_2,children:(0,p.jsx)("div",{className:"hall-of-fame",children:(0,p.jsxs)("div",{className:"card",children:[(0,p.jsx)(m,{setBindText:R,bindText:$,setBindAuthor:O,bindAuthor:D,isDialogVisible:u,setDialogVisibility:h}),(0,p.jsx)(v,{setBindText:R,bindText:$,setBindAuthor:O,bindAuthor:D,bindEditingIdRef:N,isDialogVisible:g,setDialogVisibility:x}),(0,p.jsx)(c.M,{className:"mb-4",start:A(i,h,e)}),(0,p.jsx)("div",{className:"centered-text",children:e.binds}),(0,p.jsx)("div",{className:"card",children:S?(0,p.jsx)("p",{children:"Loading..."}):(0,p.jsxs)(o.b,{value:f(t),scrollable:!0,scrollHeight:"flex",emptyMessage:e.noBindsAvailable,children:[i&&(0,p.jsx)(n.V,{field:"id",header:e.databaseId,sortable:!0}),(0,p.jsx)(n.V,{field:"author",header:e.author,sortable:!0}),(0,p.jsx)(n.V,{field:"text",header:e.text,sortable:!0}),r&&a&&a.steamid&&(0,p.jsx)(n.V,{className:"voting",header:e.voting,body:t=>j(t,a)}),i&&(0,p.jsx)(n.V,{header:e.actions,body:t=>E(t,x,O,R,N,a,e)})]})})]})})})}},7020:(t,e,i)=>{i.d(e,{Y:()=>c});const n=i.p+"static/media/background_1.bbbbf33c0f3cf7222559.jpg",o=i.p+"static/media/background_2.7713c83c2427f6bd817f.jpg",s=i.p+"static/media/background_3.4e932a7e40bb7c3fc904.jpg",d=i.p+"static/media/background_4.afd7ff29b91152c81d22.jpg",a=i.p+"static/media/background_5.4d636ab7f678d71f2368.jpg",r=i.p+"static/media/background_6.941575f694ad75fbd537.jpg",l=t=>`${t}`,c={BACKGROUND_1:l(n),BACKGROUND_2:l(o),BACKGROUND_3:l(s),BACKGROUND_4:l(d),BACKGROUND_5:l(a),BACKGROUND_6:l(r)}},9230:(t,e,i)=>{i.d(e,{A:()=>d});var n=i(5129),o=i(9987),s=i(8505);function d(t){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h5",{children:"Author"}),(0,s.jsx)(n.S,{value:o.j.replaceNonEnglishLatinChars(t.bindAuthor),onChange:e=>t.setBindAuthor(e.target.value)}),(0,s.jsx)("h5",{children:"Text"}),(0,s.jsx)(n.S,{value:o.j.replaceNonEnglishLatinChars(t.bindText),onChange:e=>t.setBindText(e.target.value)})]})}},9987:(t,e,i)=>{i.d(e,{f:()=>n,j:()=>o});const n=t=>({...t,author:t.author.replace(":","").trim()}),o={replaceNonEnglishLatinChars:t=>{const e={"A\u0300":"A","A\u0301":"A","A\u0302":"A","A\u0303":"A","A\u0308":"A","A\u030a":"A","C\u0327":"C","E\u0300":"E","E\u0301":"E","E\u0302":"E","E\u0308":"E","I\u0300":"I","I\u0301":"I","I\u0302":"I","I\u0308":"I","N\u0303":"N","O\u0300":"O","O\u0302":"O","O\u0303":"O","O\u0308":"O","O\u0327":"O","U\u0300":"U","U\u0301":"U","U\u0302":"U","U\u0308":"U","Y\u0301":"Y","a\u0300":"a","a\u0301":"a","a\u0302":"a","a\u0303":"a","a\u0308":"a","a\u030a":"a","c\u0327":"c","e\u0300":"e","e\u0301":"e","e\u0302":"e","e\u0308":"e","i\u0300":"i","i\u0301":"i","i\u0302":"i","i\u0308":"i","n\u0303":"n","o\u0300":"o","o\u0302":"o","o\u0303":"o","o\u0308":"o","o\u0327":"o","u\u0300":"u","u\u0301":"u","u\u0302":"u","u\u0308":"u","y\u0301":"y","\u0104":"A","\u0106":"C","\u0118":"E","\u0141":"L","\u0143":"N","\xd3":"O","\u015a":"S","\u0179":"Z","\u017b":"Z","\u0105":"a","\u0107":"c","\u0119":"e","\u0142":"l","\u0144":"n","\xf3":"o","\u015b":"s","\u017a":"z","\u017c":"z"};return t.normalize("NFKD").replace(/[\u0300-\u036f]/g,"").replace(/[^\u0000-\u007F]/g,t=>e[t]||t).replace(/[:;#*()]/g,"").replace("^","").replace("%"," procent")}}}}]);