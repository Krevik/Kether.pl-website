import{a as e}from"./react-vendor-Cx5UeZsH.js";import{r as t,t as r,n as o,b as n,y as a,j as s}from"./index-B2ViqwAK.js";import{u as i}from"./redux-vendor-H9NaJiP7.js";import{I as d}from"./primereact-a-ERR-hv.js";var u=(e=>(e.UPVOTE="Upvote",e.DOWNVOTE="Downvote",e))(u||{});const h={useBindsLoadingService:e=>c(e||void 0),getBinds:e=>fetch(`${t}${r.API_BASE_PATH}${r.BINDS_PATH}/getBinds`,{method:"get"}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(t=>{const r=t.map(t=>{var r,o,n,a;const s=(null==(r=t.upvote)?void 0:r.length)||0,i=(null==(o=t.downvote)?void 0:o.length)||0;let d;if(e){const r=Number(e);(null==(n=t.upvote)?void 0:n.includes(r))?d=u.UPVOTE:(null==(a=t.downvote)?void 0:a.includes(r))&&(d=u.DOWNVOTE)}return{id:t.id,author:t.author,text:t.text,votingData:{id:t.id,attachedBindID:t.id,Upvotes:s,Downvotes:i,selfVote:d}}});n.dispatch(a.setBinds(r))}).catch(e=>{o.ERROR(`Error while fetching binds: ${e.message}`)}),setVote:(e,n)=>{const a={voter_steam_id:Number(e.voterSteamID),voted_bind_id:Number(e.votedBindID),vote:e.vote};return fetch(`${t}${r.API_BASE_PATH}${r.BIND_VOTES_PATH}/${n?"deleteBindVoting":"addBindVoting"}`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then(t=>{if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return h.getBinds(e.voterSteamID),t.text()}).catch(e=>{throw o.ERROR(`Error while setting vote: ${e.message}`),e})},addNewBind:(e,n)=>fetch(`${t}${r.API_BASE_PATH}${r.BINDS_PATH}/addBind`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({author:e.author,text:e.text})}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return h.getBinds(n),e.json()}).catch(e=>{throw o.ERROR(`Error while adding new bind: ${e.message}`),e}),deleteBind:(e,n)=>fetch(`${t}${r.API_BASE_PATH}${r.BINDS_PATH}/deleteBind`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.id})}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(e=>(h.getBinds(n),e.message)).catch(e=>{throw o.ERROR(`Error while deleting bind: ${e.message}`),e}),updateBind:(e,n)=>fetch(`${t}${r.API_BASE_PATH}${r.BINDS_PATH}/updateBind`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.id,author:`${e.author}`,text:`${e.text}`})}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(e=>(h.getBinds(n),e.message)).catch(e=>{throw o.ERROR(`Error while updating bind: ${e.message}`),e})},c=t=>{const r=i(e=>e.userDataReducer.userData),[o,n]=e.useState(!0);return e.useEffect(()=>{n(!0),h.getBinds(t).finally(()=>{n(!1)})},[r,t]),o},l=e=>({...e,author:e.author.replace(":","").trim()}),g=e=>{const t={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","Ç":"C","È":"E","É":"E","Ê":"E","Ë":"E","Ì":"I","Í":"I","Î":"I","Ï":"I","Ñ":"N","Ò":"O","Ô":"O","Õ":"O","Ö":"O","O̧":"O","Ù":"U","Ú":"U","Û":"U","Ü":"U","Ý":"Y","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","ç":"c","è":"e","é":"e","ê":"e","ë":"e","ì":"i","í":"i","î":"i","ï":"i","ñ":"n","ò":"o","ô":"o","õ":"o","ö":"o","o̧":"o","ù":"u","ú":"u","û":"u","ü":"u","ý":"y","Ą":"A","Ć":"C","Ę":"E","Ł":"L","Ń":"N","Ó":"O","Ś":"S","Ź":"Z","Ż":"Z","ą":"a","ć":"c","ę":"e","ł":"l","ń":"n","ó":"o","ś":"s","ź":"z","ż":"z"};return e.normalize("NFKD").replace(/[\u0300-\u036f]/g,"").replace(/[^\u0000-\u007F]/g,e=>t[e]||e).replace(/[:;#*()]/g,"").replace("^","").replace("%"," procent")};function p(e){return s.jsxs(s.Fragment,{children:[s.jsx("h5",{children:"Author"}),s.jsx(d,{value:g(e.bindAuthor),onChange:t=>e.setBindAuthor(t.target.value)}),s.jsx("h5",{children:"Text"}),s.jsx(d,{value:g(e.bindText),onChange:t=>e.setBindText(t.target.value)})]})}export{u as B,p as D,h as b,l as t};
