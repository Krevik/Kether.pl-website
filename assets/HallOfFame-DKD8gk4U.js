import{m as t,l as e,j as i,n as s}from"./index-BOEFnIWj.js";import{e as n,B as d,f as a,b as o,d as l}from"./primereact-a-ERR-hv.js";import{u as r}from"./redux-vendor-H9NaJiP7.js";import{D as c,b as u,t as b,B as x}from"./DialogBindContent-BzaJ7GHi.js";import{a as h}from"./react-vendor-Cx5UeZsH.js";import{P as m,B as p}from"./backgrounds-LR0J5-TQ.js";import"./i18n-DzW3M4iQ.js";function g(a){const o=t(),l=e();return i.jsx(n,{visible:a.isDialogVisible,header:o.editBind,modal:!0,className:"p-fluid",footer:i.jsxs(i.Fragment,{children:[i.jsx(d,{label:l.cancel,icon:"pi pi-times",className:"p-button-text",onClick:()=>{a.bindEditingIdRef.current=-1,a.setDialogVisibility(!1)}}),i.jsx(d,{label:l.update,icon:"pi pi-check",className:"p-button-text",onClick:()=>{const t={author:a.bindAuthor,text:a.bindText,id:a.bindEditingIdRef.current};u.updateBind(t).then(()=>{s.SUCCESS("Successfully updated the bind"),a.setDialogVisibility(!1),a.bindEditingIdRef.current=-1}).catch(t=>{s.ERROR(`Couldn't update the bind: ${t}`)})}})]}),onHide:()=>{a.setDialogVisibility(!1)},children:i.jsx(c,{bindAuthor:a.bindAuthor,bindText:a.bindText,setBindAuthor:a.setBindAuthor,setBindText:a.setBindText})})}function j(a){const o=t(),l=e(),r=i.jsxs(i.Fragment,{children:[i.jsx(d,{label:l.cancel,icon:"pi pi-times",className:"p-button-text",onClick:()=>a.setDialogVisibility(!1)}),i.jsx(d,{label:l.save,icon:"pi pi-check",className:"p-button-text",onClick:()=>{const t={author:a.bindAuthor,text:a.bindText};u.addNewBind(t).then(()=>{s.SUCCESS(o.successfullyAdded),a.setDialogVisibility(!1),a.setBindText("")}).catch(t=>{s.ERROR(`${o.couldntAdd}: ${t}`)})}})]});return i.jsx(n,{visible:a.isDialogVisible,header:o.addNewBind,modal:!0,className:"p-fluid",footer:r,onHide:()=>a.setDialogVisibility(!1),children:i.jsx(c,{setBindText:a.setBindText,bindText:a.bindText,setBindAuthor:a.setBindAuthor,bindAuthor:a.bindAuthor})})}const v=t=>t.map(t=>({...t,author:`${t.author} : `})),f=(t,e,s)=>i.jsx(i.Fragment,{children:t&&i.jsx(d,{label:s.newBind,icon:"pi pi-plus",className:"p-button-success mr-2","data-toggle":"tooltip",title:s.addNewBindTooltip,onClick:()=>e(!0)})}),D=(t,e,i,n)=>{var d;const a={voterSteamID:null==i?void 0:i.steamid,votedBindID:e.id.toString(),vote:t};a.id=(null==(d=e.votingData)?void 0:d.id)||void 0,u.setVote(a,n).then(t=>{s.SUCCESS(t)}).catch(t=>{s.ERROR(t)})};function B(){const e=r(t=>t.bindsReducer.binds),n=t(),c=r(t=>t.userDataReducer.isAdmin),B=r(t=>t.userDataReducer.userData),N=r(t=>t.userDataReducer.userID),[T,R]=h.useState(!1),[C,S]=h.useState(!1),[V,A]=h.useState(""),E=h.useRef(-1),[O,y]=h.useState(""),k=u.useBindsLoadingService(null==B?void 0:B.steamid);return i.jsx(m,{imageUrl:p.BACKGROUND_2,children:i.jsx("div",{className:"hall-of-fame",children:i.jsxs("div",{className:"card",children:[i.jsx(j,{setBindText:y,bindText:O,setBindAuthor:A,bindAuthor:V,isDialogVisible:T,setDialogVisibility:R}),i.jsx(g,{setBindText:y,bindText:O,setBindAuthor:A,bindAuthor:V,bindEditingIdRef:E,isDialogVisible:C,setDialogVisibility:S}),i.jsx(a,{className:"mb-4",start:f(c,R,n)}),i.jsx("div",{className:"centered-text",children:n.binds}),i.jsx("div",{className:"card",children:k?i.jsx("p",{children:"Loading..."}):i.jsxs(o,{value:v(e),scrollable:!0,scrollHeight:"flex",emptyMessage:n.noBindsAvailable,children:[c&&i.jsx(l,{field:"id",header:n.databaseId,sortable:!0}),i.jsx(l,{field:"author",header:n.author,sortable:!0}),i.jsx(l,{field:"text",header:n.text,sortable:!0}),N&&B&&B.steamid&&i.jsx(l,{className:"voting",header:n.voting,body:t=>((t,e)=>{var s,n,a;const o=null==(s=t.votingData)?void 0:s.selfVote,l="vote-up-button "+(o&&o===x.UPVOTE?"self-voted":""),r="vote-down-button "+(o&&o===x.DOWNVOTE?"self-voted":"");return i.jsxs(i.Fragment,{children:[i.jsx(d,{className:l,icon:"pi pi-thumbs-up",onClick:()=>{D(x.UPVOTE,t,e,o&&o===x.UPVOTE)},children:(null==(n=t.votingData)?void 0:n.Upvotes)||0}),i.jsx(d,{className:r,icon:"pi pi-thumbs-down",onClick:()=>{D(x.DOWNVOTE,t,e,o&&o===x.DOWNVOTE)},children:(null==(a=t.votingData)?void 0:a.Downvotes)||0})]})})(t,B)}),c&&i.jsx(l,{header:n.actions,body:t=>((t,e,n,a,o,l,r)=>i.jsxs(i.Fragment,{children:[i.jsx(d,{"data-toggle":"tooltip",title:r.editBindTooltip,icon:"pi pi-pencil",className:"p-button-rounded p-button-warning mr-2",onClick:()=>{o.current=t.id,e(!0),n(b(t).author),a(t.text)}}),i.jsx(d,{"data-toggle":"tooltip",title:r.deleteBindTooltip,icon:"pi pi-trash",className:"p-button-rounded p-button-danger",onClick:()=>{u.deleteBind(t,null==l?void 0:l.steamid).then(t=>{s.SUCCESS(`${t}`)}).catch(t=>{s.ERROR(`${r.couldntDelete}: ${t}`)})}})]}))(t,S,A,y,E,B,n)})]})})]})})})}export{B as default};
