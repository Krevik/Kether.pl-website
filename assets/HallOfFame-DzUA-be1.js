import{m as e,l as t,j as i,n as s}from"./index-B2ViqwAK.js";import{e as a,B as d,f as n,b as o,d as l}from"./primereact-a-ERR-hv.js";import{u as r}from"./redux-vendor-H9NaJiP7.js";import{D as c,b as u,t as b,B as x}from"./DialogBindContent-DdONjZiP.js";import{a as h}from"./react-vendor-Cx5UeZsH.js";import{P as m,B as g}from"./backgrounds-DNADzbsU.js";import"./i18n-DzW3M4iQ.js";function j(n){const o=e(),l=t();return i.jsx(a,{visible:n.isDialogVisible,header:o.editBind,modal:!0,className:"p-fluid",footer:i.jsxs(i.Fragment,{children:[i.jsx(d,{label:`❌ ${l.cancel}`,className:"p-button-text",onClick:()=>{n.bindEditingIdRef.current=-1,n.setDialogVisibility(!1)}}),i.jsx(d,{label:`✅ ${l.update}`,className:"p-button-text",onClick:()=>{const e={author:n.bindAuthor,text:n.bindText,id:n.bindEditingIdRef.current};u.updateBind(e).then(()=>{s.SUCCESS("Successfully updated the bind"),n.setDialogVisibility(!1),n.bindEditingIdRef.current=-1}).catch(e=>{s.ERROR(`Couldn't update the bind: ${e}`)})}})]}),onHide:()=>{n.setDialogVisibility(!1)},children:i.jsx(c,{bindAuthor:n.bindAuthor,bindText:n.bindText,setBindAuthor:n.setBindAuthor,setBindText:n.setBindText})})}function v(n){const o=e(),l=t(),r=i.jsxs(i.Fragment,{children:[i.jsx(d,{label:`❌ ${l.cancel}`,className:"p-button-text",onClick:()=>n.setDialogVisibility(!1)}),i.jsx(d,{label:`✅ ${l.save}`,className:"p-button-text",onClick:()=>{const e={author:n.bindAuthor,text:n.bindText};u.addNewBind(e).then(()=>{s.SUCCESS(o.successfullyAdded),n.setDialogVisibility(!1),n.setBindText("")}).catch(e=>{s.ERROR(`${o.couldntAdd}: ${e}`)})}})]});return i.jsx(a,{visible:n.isDialogVisible,header:o.addNewBind,modal:!0,className:"p-fluid",footer:r,onHide:()=>n.setDialogVisibility(!1),children:i.jsx(c,{setBindText:n.setBindText,bindText:n.bindText,setBindAuthor:n.setBindAuthor,bindAuthor:n.bindAuthor})})}const p=e=>e.map(e=>({...e,author:`${e.author} : `})),f=(e,t,s)=>i.jsx(i.Fragment,{children:e&&i.jsx(d,{label:`➕ ${s.newBind}`,className:"p-button-success mr-2","data-toggle":"tooltip",title:s.addNewBindTooltip,onClick:()=>t(!0)})}),D=(e,t,i,a)=>{var d;const n={voterSteamID:null==i?void 0:i.steamid,votedBindID:t.id.toString(),vote:e};n.id=(null==(d=t.votingData)?void 0:d.id)||void 0,u.setVote(n,a).then(e=>{s.SUCCESS(e)}).catch(e=>{s.ERROR(e)})};function B(){const t=r(e=>e.bindsReducer.binds),a=e(),c=r(e=>e.userDataReducer.isAdmin),B=r(e=>e.userDataReducer.userData),N=r(e=>e.userDataReducer.userID),[T,R]=h.useState(!1),[C,S]=h.useState(!1),[V,A]=h.useState(""),E=h.useRef(-1),[O,$]=h.useState(""),y=u.useBindsLoadingService(null==B?void 0:B.steamid);return i.jsx(m,{imageUrl:g.BACKGROUND_2,children:i.jsx("div",{className:"hall-of-fame",children:i.jsxs("div",{className:"card",children:[i.jsx(v,{setBindText:$,bindText:O,setBindAuthor:A,bindAuthor:V,isDialogVisible:T,setDialogVisibility:R}),i.jsx(j,{setBindText:$,bindText:O,setBindAuthor:A,bindAuthor:V,bindEditingIdRef:E,isDialogVisible:C,setDialogVisibility:S}),i.jsx(n,{className:"mb-4",start:f(c,R,a)}),i.jsx("div",{className:"centered-text",children:a.binds}),i.jsx("div",{className:"card",children:y?i.jsx("p",{children:"Loading..."}):i.jsxs(o,{value:p(t),scrollable:!0,scrollHeight:"flex",emptyMessage:a.noBindsAvailable,children:[c&&i.jsx(l,{field:"id",header:a.databaseId,sortable:!0}),i.jsx(l,{field:"author",header:a.author,sortable:!0}),i.jsx(l,{field:"text",header:a.text,sortable:!0}),N&&B&&B.steamid&&i.jsx(l,{className:"voting",header:a.voting,body:e=>((e,t)=>{var s,a,n;const o=null==(s=e.votingData)?void 0:s.selfVote,l="vote-up-button "+(o&&o===x.UPVOTE?"self-voted":""),r="vote-down-button "+(o&&o===x.DOWNVOTE?"self-voted":"");return i.jsxs(i.Fragment,{children:[i.jsx(d,{className:l,label:`👍 ${(null==(a=e.votingData)?void 0:a.Upvotes)||0}`,onClick:()=>{D(x.UPVOTE,e,t,o&&o===x.UPVOTE)}}),i.jsx(d,{className:r,label:`👎 ${(null==(n=e.votingData)?void 0:n.Downvotes)||0}`,onClick:()=>{D(x.DOWNVOTE,e,t,o&&o===x.DOWNVOTE)}})]})})(e,B)}),c&&i.jsx(l,{header:a.actions,body:e=>((e,t,a,n,o,l,r)=>i.jsxs(i.Fragment,{children:[i.jsx(d,{"data-toggle":"tooltip",title:r.editBindTooltip,label:"✏️",className:"p-button-rounded p-button-warning mr-2",onClick:()=>{o.current=e.id,t(!0),a(b(e).author),n(e.text)}}),i.jsx(d,{"data-toggle":"tooltip",title:r.deleteBindTooltip,label:"🗑️",className:"p-button-rounded p-button-danger",onClick:()=>{u.deleteBind(e,null==l?void 0:l.steamid).then(e=>{s.SUCCESS(`${e}`)}).catch(e=>{s.ERROR(`${r.couldntDelete}: ${e}`)})}})]}))(e,S,A,$,E,B,a)})]})})]})})})}export{B as default};
