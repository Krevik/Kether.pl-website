import{a as e}from"./react-vendor-CFOk4vZh.js";import{x as t,y as o,n as r,b as n,C as a,o as s,j as i}from"./index-PUGTdxub.js";import{u as d}from"./redux-vendor-y6Da-rhS.js";import{I as u}from"./primereact-C2ngy8op.js";var h=(e=>(e.UPVOTE="Upvote",e.DOWNVOTE="Downvote",e))(h||{});const c={useBindsLoadingService:e=>l(e||void 0),getBinds:e=>fetch(`${t}${o.API_BASE_PATH}${o.BINDS_PATH}/getBinds`,{method:"get"}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(t=>{const o=t.map(t=>{var o,r,n,a;const s=(null==(o=t.upvote)?void 0:o.length)||0,i=(null==(r=t.downvote)?void 0:r.length)||0;let d;if(e){const o=Number(e);(null==(n=t.upvote)?void 0:n.includes(o))?d=h.UPVOTE:(null==(a=t.downvote)?void 0:a.includes(o))&&(d=h.DOWNVOTE)}return{id:t.id,author:t.author,text:t.text,votingData:{id:t.id,attachedBindID:t.id,Upvotes:s,Downvotes:i,selfVote:d}}});n.dispatch(a.setBinds(o))}).catch(e=>{r.ERROR(`Error while fetching binds: ${e.message}`)}),setVote:(e,n)=>{const a={voter_steam_id:Number(e.voterSteamID),voted_bind_id:Number(e.votedBindID),vote:e.vote};return fetch(`${t}${o.API_BASE_PATH}${o.BIND_VOTES_PATH}/${n?"deleteBindVoting":"addBindVoting"}`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then(t=>{if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return c.getBinds(e.voterSteamID),t.text()}).catch(e=>{throw r.ERROR(`Error while setting vote: ${e.message}`),e})},addNewBind:(e,n)=>fetch(`${t}${o.API_BASE_PATH}${o.BINDS_PATH}/addBind`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({author:e.author,text:e.text})}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return c.getBinds(n),e.json()}).catch(e=>{throw r.ERROR(`Error while adding new bind: ${e.message}`),e}),deleteBind:(e,n)=>fetch(`${t}${o.API_BASE_PATH}${o.BINDS_PATH}/deleteBind`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.id})}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(e=>(c.getBinds(n),e.message)).catch(e=>{throw r.ERROR(`Error while deleting bind: ${e.message}`),e}),updateBind:(e,n)=>fetch(`${t}${o.API_BASE_PATH}${o.BINDS_PATH}/updateBind`,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.id,author:`${e.author}`,text:`${e.text}`})}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}).then(e=>(c.getBinds(n),e.message)).catch(e=>{throw r.ERROR(`Error while updating bind: ${e.message}`),e})},l=t=>{const o=d(e=>e.userDataReducer.userData),[r,n]=e.useState(!0);return e.useEffect(()=>{n(!0),c.getBinds(t).finally(()=>{n(!1)})},[o,t]),r},p=e=>({...e,author:e.author.replace(":","").trim()}),g=e=>{const t={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","Ç":"C","È":"E","É":"E","Ê":"E","Ë":"E","Ì":"I","Í":"I","Î":"I","Ï":"I","Ñ":"N","Ò":"O","Ô":"O","Õ":"O","Ö":"O","O̧":"O","Ù":"U","Ú":"U","Û":"U","Ü":"U","Ý":"Y","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","ç":"c","è":"e","é":"e","ê":"e","ë":"e","ì":"i","í":"i","î":"i","ï":"i","ñ":"n","ò":"o","ô":"o","õ":"o","ö":"o","o̧":"o","ù":"u","ú":"u","û":"u","ü":"u","ý":"y","Ą":"A","Ć":"C","Ę":"E","Ł":"L","Ń":"N","Ó":"O","Ś":"S","Ź":"Z","Ż":"Z","ą":"a","ć":"c","ę":"e","ł":"l","ń":"n","ó":"o","ś":"s","ź":"z","ż":"z"};return e.normalize("NFKD").replace(/[\u0300-\u036f]/g,"").replace(/[^\u0000-\u007F]/g,e=>t[e]||e).replace(/[:;#*()]/g,"").replace("^","").replace("%"," procent")};function A(e){const t=s();return i.jsxs(i.Fragment,{children:[i.jsx("h5",{children:t.author}),i.jsx(u,{className:"app-focus-ring",value:g(e.bindAuthor),onChange:t=>e.setBindAuthor(t.target.value)}),i.jsx("h5",{children:t.text}),i.jsx(u,{className:"app-focus-ring",value:g(e.bindText),onChange:t=>e.setBindText(t.target.value)})]})}export{h as B,A as D,c as b,p as t};
