import{o as e,m as t,j as i,n as s}from"./index-PUGTdxub.js";import{e as a,B as n,f as d,b as o,d as l}from"./primereact-C2ngy8op.js";import{u as r}from"./redux-vendor-y6Da-rhS.js";import{D as c,b as u,t as b,B as p}from"./DialogBindContent-DiYjcHqK.js";import{a as x}from"./react-vendor-CFOk4vZh.js";import{P as g,B as m}from"./backgrounds-cpbz9wIW.js";import"./i18n-X45JNxKt.js";function h(d){const o=e(),l=t();return i.jsx(a,{visible:d.isDialogVisible,header:o.editBind,modal:!0,className:"p-fluid app-dialog",footer:i.jsxs(i.Fragment,{children:[i.jsx(n,{label:`âŒ ${l.cancel}`,className:"p-button-text app-focus-ring",onClick:()=>{d.bindEditingIdRef.current=-1,d.setDialogVisibility(!1)}}),i.jsx(n,{label:`âœ… ${l.update}`,className:"p-button-text app-focus-ring",onClick:()=>{const e={author:d.bindAuthor,text:d.bindText,id:d.bindEditingIdRef.current};u.updateBind(e).then(()=>{s.SUCCESS(l.update),d.setDialogVisibility(!1),d.bindEditingIdRef.current=-1}).catch(e=>{s.ERROR(`${l.error}: ${e}`)})}})]}),onHide:()=>{d.setDialogVisibility(!1)},children:i.jsx(c,{bindAuthor:d.bindAuthor,bindText:d.bindText,setBindAuthor:d.setBindAuthor,setBindText:d.setBindText})})}function j(d){const o=e(),l=t(),r=i.jsxs(i.Fragment,{children:[i.jsx(n,{label:`âŒ ${l.cancel}`,className:"p-button-text app-focus-ring",onClick:()=>d.setDialogVisibility(!1)}),i.jsx(n,{label:`âœ… ${l.save}`,className:"p-button-text app-focus-ring",onClick:()=>{const e={author:d.bindAuthor,text:d.bindText};u.addNewBind(e).then(()=>{s.SUCCESS(o.successfullyAdded),d.setDialogVisibility(!1),d.setBindText("")}).catch(e=>{s.ERROR(`${o.couldntAdd}: ${e}`)})}})]});return i.jsx(a,{visible:d.isDialogVisible,header:o.addNewBind,modal:!0,className:"p-fluid app-dialog",footer:r,onHide:()=>d.setDialogVisibility(!1),children:i.jsx(c,{setBindText:d.setBindText,bindText:d.bindText,setBindAuthor:d.setBindAuthor,bindAuthor:d.bindAuthor})})}const f=e=>e.map(e=>({...e,author:`${e.author} : `})),v=(e,t,s)=>i.jsx(i.Fragment,{children:e&&i.jsx(n,{label:`âž• ${s.newBind}`,className:"p-button-success mr-2 app-focus-ring","data-toggle":"tooltip",title:s.addNewBindTooltip,onClick:()=>t(!0)})}),D=(e,t,i,a)=>{var n;const d={voterSteamID:null==i?void 0:i.steamid,votedBindID:t.id.toString(),vote:e};d.id=(null==(n=t.votingData)?void 0:n.id)||void 0,u.setVote(d,a).then(e=>{s.SUCCESS(e)}).catch(e=>{s.ERROR(e)})};function B(){const t=r(e=>e.bindsReducer.binds),a=e(),c=r(e=>e.userDataReducer.isAdmin),B=r(e=>e.userDataReducer.userData),N=r(e=>e.userDataReducer.userID),[T,R]=x.useState(!1),[V,A]=x.useState(!1),[C,S]=x.useState(""),E=x.useRef(-1),[$,O]=x.useState(""),y=u.useBindsLoadingService(null==B?void 0:B.steamid);return i.jsx(g,{imageUrl:m.BACKGROUND_2,children:i.jsx("div",{className:"hall-of-fame",children:i.jsxs("div",{className:"card app-surface app-page-card",children:[i.jsx(j,{setBindText:O,bindText:$,setBindAuthor:S,bindAuthor:C,isDialogVisible:T,setDialogVisibility:R}),i.jsx(h,{setBindText:O,bindText:$,setBindAuthor:S,bindAuthor:C,bindEditingIdRef:E,isDialogVisible:V,setDialogVisibility:A}),i.jsx(d,{className:"mb-4 app-toolbar",start:v(c,R,a)}),i.jsx("div",{className:"centered-text",children:a.binds}),i.jsx("div",{className:"card",children:y?i.jsx("p",{children:"Loading..."}):i.jsxs(o,{value:f(t),className:"app-data-table",scrollable:!0,scrollHeight:"flex",emptyMessage:a.noBindsAvailable,children:[c&&i.jsx(l,{field:"id",header:a.databaseId,sortable:!0}),i.jsx(l,{field:"author",header:a.author,sortable:!0}),i.jsx(l,{field:"text",header:a.text,sortable:!0}),N&&B&&B.steamid&&i.jsx(l,{className:"voting",header:a.voting,body:e=>((e,t)=>{var s,a,d;const o=null==(s=e.votingData)?void 0:s.selfVote,l="vote-up-button "+(o&&o===p.UPVOTE?"self-voted":""),r="vote-down-button "+(o&&o===p.DOWNVOTE?"self-voted":"");return i.jsxs(i.Fragment,{children:[i.jsx(n,{className:`${l} app-focus-ring`,label:`ðŸ‘ðŸ» ${(null==(a=e.votingData)?void 0:a.Upvotes)||0}`,onClick:()=>{D(p.UPVOTE,e,t,o&&o===p.UPVOTE)}}),i.jsx(n,{className:`${r} app-focus-ring`,label:`ðŸ‘ŽðŸ» ${(null==(d=e.votingData)?void 0:d.Downvotes)||0}`,onClick:()=>{D(p.DOWNVOTE,e,t,o&&o===p.DOWNVOTE)}})]})})(e,B)}),c&&i.jsx(l,{header:a.actions,body:e=>((e,t,a,d,o,l,r)=>i.jsxs(i.Fragment,{children:[i.jsx(n,{"data-toggle":"tooltip",title:r.editBindTooltip,label:"âœï¸",className:"p-button-rounded p-button-warning mr-2 app-focus-ring",onClick:()=>{o.current=e.id,t(!0),a(b(e).author),d(e.text)}}),i.jsx(n,{"data-toggle":"tooltip",title:r.deleteBindTooltip,label:"ðŸ—‘ï¸",className:"p-button-rounded p-button-danger app-focus-ring",onClick:()=>{u.deleteBind(e,null==l?void 0:l.steamid).then(e=>{s.SUCCESS(`${e}`)}).catch(e=>{s.ERROR(`${r.couldntDelete}: ${e}`)})}})]}))(e,A,S,O,E,B,a)})]})})]})})})}export{B as default};
